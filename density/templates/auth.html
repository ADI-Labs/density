{% extends "layout.html" %}

{% block head %}
    {{ super() }}
    <script src="https://apis.google.com/js/client:platform.js" async defer></script>
{% endblock %}

{% block body %}

<div class="container main-body">
  {% if success %}
    <h1> Welcome {{ uni }}! </h1>
    <h5> Your code is: {{ code }} </h5>
  {% else %}
    {% if reason %}
      <h1 style="color:red"> {{ reason }} </h1>
    {% endif %}
    <h1>Wireless Density Data for Columbia University</h1>
    <h5>Welcome to Density, an API that gives Columbia developers access to wireless density data.</h5>

    <h3>Getting access to the API</h3>
    <h5>To use the API, you will need a Columbia or Barnard e-mail address.</h5>
    <button id='signinButton' onclick='login()'>
        Get access
    </button>

    <script>
      function login() {
          var params = {
              'callback': signinCallback,
              'clientid': '115421531871-jj9kl2nsp4ebjv26ggms597jq7s529b6.apps.googleusercontent.com',
              'scope': 'https://www.googleapis.com/auth/plus.profile.emails.read',
              'requestvisibleactions': 'http://schema.org/AddAction',
              'cookiepolicy': 'single_host_origin'
          };
          gapi.auth.signIn(params);
      }
      function signinCallback(authResult) {
          if (authResult['status']['signed_in']) {
          // Update the app to reflect a signed in user
          // Hide the sign-in button now that the user is authorized, for example:
          document.location.href = '/auth?code=' + authResult.code
        }
      }
    </script>

  {% endif %}
</div>

{% endblock %}