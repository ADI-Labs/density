{% extends "layout.html" %}
{% block body %}
<div class="listContainer">

    <h3>Please leave feedback to help improve our predictions!</h3>

    {% include 'search.html' %}

    <div class="container">
        <ul class="list-group">
            {% for location in locations %}
              <li class="list-group-item" data-name="{{ location['group_name'] }}" 
                                          data-nickname="{{ auxdata[location['group_name']]['nickname'] }}"
                                          data-location-type="{{ auxdata[location['group_name']]['type'] }}"
                                          data-open-now="{{ auxdata[location['group_name']]['open'] }}">
                <h4>{{ location['group_name'] }}<span class="opening-time">{{times[location['group_name']]}}</span></h4>
                  <button class="feedback-button" onclick="openFeedback('{{ location['group_name'] }}', '{{ location['group_id'] }}', '{{ location['percent_full'] }}')">Feedback</button>
                  <div class="progress">
                      {% if location['percent_full'] <= 2 %}
                          <div class="progress-bar progress-bar-info progress-bar-striped active"
                             role="progressbar" aria-valuenow="0"
                             aria-valuemin="0" aria-valuemax="100"
                             style="width: 0;">
                             {{ location['percent_full'] }}%
                          </div>
                      {% else %}

                          <div class="progress-bar progress-bar-info progress-bar-striped active"
                             role="progressbar" aria-valuenow="{{location['percent_full']}}"
                             aria-valuemin="0" aria-valuemax="100"
                             style="width: {{location['percent_full']}}%;">
                             {{ location['percent_full'] }}%
                          </div>
                      {% endif %}
                  </div>
              </li>
            {% endfor %}
        </ul>
    </div>
    <div class="update">Last updated {{ last_updated }}</div>
    <div class="update"> 
        <span class="opening-time">
        * Library opening and closing times may vary during Finals week and University Holidays
        </span>
    </div>
</div>
<div class="thanksContainer">
    <div class="container">
        <h4>Special thanks to <img class="logo escLogo" src="{{ url_for('static', filename='img/esc.png')}}">
        </h4>
    </div>
</div>
<div id="feedback" style="display: none;">
  <h2>Feedback<br><span><i>We use your feedback to help improve the accuracy of our predictions.</i></span></h2>
  <div id="close" onclick="closeFeedback()">x</div>
  <p>Is our prediction that <span id="building" class="blue"></span> is <span id="percentage" class="blue"></span><span class="blue">%</span> full accurate? The percentage should be:</p>
  <div>
    <div><input type="radio" name="capacity" value="0" id="r1"><label for="r1">Much Lower</label></div>
    <div><input type="radio" name="capacity" value="1" id="r2"><label for="r2">Lower</label></div>
    <div><input type="radio" name="capacity" value="2" id="r3"><label for="r3">Perfect</label></div>
    <div><input type="radio" name="capacity" value="3" id="r4"><label for="r4">Higher</label></div>
    <div><input type="radio" name="capacity" value="4" id="r5"><label for="r5">Much Higher</label></div>
  </div>
  <p class="flex">
    <i>Ex: &#34;Lower&#34; means you believe <span id="building" class="blue"></span> is at less than <span id="percentage" class="blue"></span><span class="blue">%</span> capacity. </i> 
    <button id="send-feedback" onclick="sendFeedback()">Submit</button>
  </p>
  <section id="feedback-thanks" style="display: none;">Thank you!</section>
</div>

{% endblock %}

{% block scripts %}
    <script src="{{ url_for('static', filename='js/capacity.js') }}"></script>
{% endblock %}